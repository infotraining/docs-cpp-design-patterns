
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Factory Method &#8212; Design Patterns in C++</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=4b992f07" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'creational/factory-method';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Abstract Factory" href="abstract-factory.html" />
    <link rel="prev" title="Factories" href="../factories.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Design Patterns in C++ - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Design Patterns in C++ - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../oop.html">Foundations of Object-Oriented Programming</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../solid/solid.html">S.O.L.I.D. Principles</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../solid/srp.html">Single Responsibility Principle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../solid/ocp.html">Open/Closed Principle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../solid/lsp.html">Liskov Substitution Principle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../solid/isp.html">Interface Segregation Principle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../solid/dip.html">Dependency Inversion Principle</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../design-patterns.html">Design Patterns</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="creational.html">Creational Patterns</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../factories.html">Factories</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Factory Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="abstract-factory.html">Abstract Factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="prototype.html">Prototype</a></li>
<li class="toctree-l2"><a class="reference internal" href="builder.html">Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="singleton.html">Singleton</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/infotraining/docs-cpp-design-patterns" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/infotraining/docs-cpp-design-patterns/issues/new?title=Issue%20on%20page%20%2Fcreational/factory-method.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/creational/factory-method.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Factory Method</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intent">Intent</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-from-problem-to-solution">Example - from problem to solution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factory-method-context">Factory Method - Context</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factory-method-problem">Factory Method - Problem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factory-method-structure">Factory Method - Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factory-method-collaboration">Factory Method - Collaboration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factory-method-consequences">Factory Method - Consequences</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parallel-class-hierarchies">Parallel Class Hierarchies</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#factory-method-implementation">Factory Method - Implementation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameterized-factories">Parameterized Factories</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#factory-method-related-patterns">Factory Method - Related Patterns</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="factory-method">
<h1>Factory Method<a class="headerlink" href="#factory-method" title="Link to this heading">#</a></h1>
<section id="intent">
<h2>Intent<a class="headerlink" href="#intent" title="Link to this heading">#</a></h2>
<p><strong>Factory Method</strong> is a creational design pattern that provides an interface for creating objects and allows its implementors to alter the type of objects that will be created.</p>
</section>
<section id="example-from-problem-to-solution">
<h2>Example - from problem to solution<a class="headerlink" href="#example-from-problem-to-solution" title="Link to this heading">#</a></h2>
<p>The class is strongly coupled to the concrete classes it creates. This makes it hard to change the class’s behavior or replace the concrete classes with other classes.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MusicApp</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">//...</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">play</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">track_title</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// creation of the object</span>
<span class="w">        </span><span class="n">SpotifyService</span><span class="w"> </span><span class="n">music_service</span><span class="p">(</span><span class="s">&quot;spotify_user&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;rjdaslf276%2&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="p">);</span>
<span class="w">        </span>
<span class="w">        </span><span class="c1">// usage of the object</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">optional</span><span class="o">&lt;</span><span class="n">Track</span><span class="o">&gt;</span><span class="w"> </span><span class="n">track</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">music_service</span><span class="p">.</span><span class="n">get_track</span><span class="p">(</span><span class="n">track_title</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">track</span><span class="p">.</span><span class="n">has_value</span><span class="p">())</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">music_service</span><span class="p">.</span><span class="n">play</span><span class="p">(</span><span class="n">track</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="c1">//... handle error</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">//...rest of the class</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The <strong>Factory Method</strong> pattern suggests defining an interface for creating objects, but lets subclasses decide which class to instantiate. This way, the class delegates the object creation to its subclasses.</p>
<p>We can start with extracting an interface for the music service:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MusicService</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">optional</span><span class="o">&lt;</span><span class="n">Track</span><span class="o">&gt;</span><span class="w"> </span><span class="n">get_track</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">title</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">   </span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">play</span><span class="p">(</span><span class="n">Track</span><span class="w"> </span><span class="n">track</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">MusicService</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Any specific music service should implement this interface. For example, the <code class="docutils literal notranslate"><span class="pre">SpotifyService</span></code> or <code class="docutils literal notranslate"><span class="pre">AppleMusicService</span></code>.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">SpotifyService</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">MusicService</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">SpotifyService</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">port</span><span class="p">);</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">optional</span><span class="o">&lt;</span><span class="n">Track</span><span class="o">&gt;</span><span class="w"> </span><span class="n">get_track</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">title</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">play</span><span class="p">(</span><span class="n">Track</span><span class="w"> </span><span class="n">track</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Then we can abstract the process of creating the music service instance:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MusicServiceCreator</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">MusicService</span><span class="o">&gt;</span><span class="w"> </span><span class="n">create_music_service</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">MusicServiceCreator</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">MusicApp</span></code> class can now delegate the responsibility of creating the music service to the objects implementing the <code class="docutils literal notranslate"><span class="pre">MusicServiceCreator</span></code> interface. The creator can be injected as dependency to the <code class="docutils literal notranslate"><span class="pre">MusicApp</span></code> class.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MusicApp</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">MusicServiceCreator</span><span class="o">&gt;</span><span class="w"> </span><span class="n">music_service_creator_</span><span class="p">;</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">MusicApp</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">MusicServiceCreator</span><span class="o">&gt;</span><span class="w"> </span><span class="n">music_service_creator</span><span class="p">)</span><span class="w"> </span><span class="c1">// DI - Dependency Injection</span>
<span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">music_service_creator_</span><span class="p">(</span><span class="n">music_service_creator</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">play</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">track_title</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// creation of the object</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">MusicService</span><span class="o">&gt;</span><span class="w"> </span><span class="n">music_service</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">            </span><span class="n">music_service_creator_</span><span class="o">-&gt;</span><span class="n">create_music_service</span><span class="p">();</span>

<span class="w">        </span><span class="c1">// usage of the object</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">optional</span><span class="o">&lt;</span><span class="n">Track</span><span class="o">&gt;</span><span class="w"> </span><span class="n">track</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">music_service</span><span class="o">-&gt;</span><span class="n">get_track</span><span class="p">(</span><span class="n">track_title</span><span class="p">);</span>

<span class="w">        </span><span class="c1">//...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Now the process of creating the music service is encapsulated in the <code class="docutils literal notranslate"><span class="pre">MusicServiceCreator</span></code> object. The <code class="docutils literal notranslate"><span class="pre">MusicApp</span></code> class is no longer responsible for creating the music service object.
Moreover, the <code class="docutils literal notranslate"><span class="pre">MusicApp</span></code> class is no longer coupled to the concrete class of the music service. It can work with any class that implements the <code class="docutils literal notranslate"><span class="pre">MusicServiceCreator</span></code> interface. The process of instantiating the music service is separated from the usage of the music service.</p>
</section>
<section id="factory-method-context">
<h2>Factory Method - Context<a class="headerlink" href="#factory-method-context" title="Link to this heading">#</a></h2>
<p>We want to introduce a new functionality by writing a new class and creating an instance of that class.</p>
</section>
<section id="factory-method-problem">
<h2>Factory Method - Problem<a class="headerlink" href="#factory-method-problem" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>We want to instantiate concrete classes through an abstract interface</p></li>
<li><p>A given class cannot anticipate the type of object to be created</p></li>
<li><p>Information about the type of object to be created is available only at runtime</p></li>
<li><p>Object creation should be separated from the object usage</p></li>
</ul>
</section>
<section id="factory-method-structure">
<h2>Factory Method - Structure<a class="headerlink" href="#factory-method-structure" title="Link to this heading">#</a></h2>
<p><img alt="" src="../_images/Factory.png" /></p>
</section>
<section id="factory-method-collaboration">
<h2>Factory Method - Collaboration<a class="headerlink" href="#factory-method-collaboration" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">Creator</span></code> class object delegates to its derived classes the responsibility of defining the factory method to create an instance of the appropriate <code class="docutils literal notranslate"><span class="pre">ConcreteProduct</span></code> class (a subclass of the abstract <code class="docutils literal notranslate"><span class="pre">Product</span></code> class)</p></li>
</ul>
</section>
<section id="factory-method-consequences">
<h2>Factory Method - Consequences<a class="headerlink" href="#factory-method-consequences" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Eliminates the need to insert specific classes into the application code.</p></li>
<li><p>Creating objects within a class using a factory method is more flexible than creating them directly.</p></li>
<li><p>Promotes loose coupling by reducing dependencies to concrete classes specific classes in your code.</p></li>
</ul>
</section>
<section id="parallel-class-hierarchies">
<h2>Parallel Class Hierarchies<a class="headerlink" href="#parallel-class-hierarchies" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Parallel class hierarchies arise when a class delegates some of its responsibilities to a separate class</p></li>
</ul>
<p><img alt="" src="../_images/Factory-ShapeManipulator.png" /></p>
<ul class="simple">
<li><p>The Factory Method pattern allows combining parallel class hierarchies</p></li>
</ul>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Shape</span><span class="o">&gt;</span><span class="w"> </span><span class="n">selected_shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_clicked_shape</span><span class="p">();</span>

<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Manipulator</span><span class="o">&gt;</span><span class="w"> </span><span class="n">manipulator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">selected_shape</span><span class="o">-&gt;</span><span class="n">create_manipulator</span><span class="p">();</span>

<span class="n">manipulator</span><span class="o">-&gt;</span><span class="n">on_drag</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p">);</span>
</pre></div>
</div>
<section id="factory-method-implementation">
<h3>Factory Method - Implementation<a class="headerlink" href="#factory-method-implementation" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>We can implement the factory class as:</p>
<ul>
<li><p>An abstract class (interface) that does not provide implementations for the methods it declares</p></li>
<li><p>A concrete class that provides a default implementation of the factory method, but can be overridden by derived classes</p></li>
</ul>
</li>
<li><p>In a simple case, the factory interface can be replaced with a type</p></li>
</ul>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">MusicServiceCreator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">MusicService</span><span class="o">&gt;</span><span class="p">()</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="parameterized-factories">
<h3>Parameterized Factories<a class="headerlink" href="#parameterized-factories" title="Link to this heading">#</a></h3>
<p>Parameterized factories are used when the type of object to be created depends on the identifier passed to the factory method. As a result, a single factory instance can create objects of different types.
Identifiers can be of different types, such as <code class="docutils literal notranslate"><span class="pre">std::string</span></code>, <code class="docutils literal notranslate"><span class="pre">enum</span></code>, or any other type that can be used to determine the type of object to be created.
The information what type of object to create arrives very often at runtime (when parsing configuration files, user input, etc.).</p>
<p>Such a factory can be implemented as follows:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">MusicServiceCreator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">MusicService</span><span class="o">&gt;</span><span class="p">()</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MusicServiceFactory</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">MusicServiceCreator</span><span class="o">&gt;</span><span class="w"> </span><span class="n">creators_</span><span class="p">;</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">MusicService</span><span class="o">&gt;</span><span class="w"> </span><span class="n">create</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">const</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">creator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">creators_</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">creator</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">register_creator</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">MusicServiceCreator</span><span class="o">&amp;</span><span class="w"> </span><span class="n">creator</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">creators_</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">creator</span><span class="p">).</span><span class="n">second</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The creators are registered with the factory using the <code class="docutils literal notranslate"><span class="pre">register_creator</span></code> method. As a creator, we can use a lambda function that creates an instance of the desired class.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">MusicServiceFactory</span><span class="w"> </span><span class="n">music_service_factory</span><span class="p">;</span>

<span class="n">music_service_factory</span><span class="p">.</span><span class="n">register_creator</span><span class="p">(</span><span class="s">&quot;Tidal&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="p">[]</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">TidalService</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;tidal_user&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;KJH8324d&amp;df&quot;</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>

<span class="c1">//...</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">id_from_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Tidal&quot;</span><span class="p">;</span>
<span class="n">MusicApp</span><span class="w"> </span><span class="nf">app</span><span class="p">(</span><span class="n">music_service_factory</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">id_from_config</span><span class="p">));</span>
</pre></div>
</div>
</section>
<section id="factory-method-related-patterns">
<h3>Factory Method - Related Patterns<a class="headerlink" href="#factory-method-related-patterns" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Iterator</p></li>
<li><p>Abstract Factory
– an abstract factory is often implemented using factory methods</p></li>
<li><p>Template Method
– factory methods are often called within an algorithm implemented as template method</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./creational"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../factories.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Factories</p>
      </div>
    </a>
    <a class="right-next"
       href="abstract-factory.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Abstract Factory</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intent">Intent</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-from-problem-to-solution">Example - from problem to solution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factory-method-context">Factory Method - Context</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factory-method-problem">Factory Method - Problem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factory-method-structure">Factory Method - Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factory-method-collaboration">Factory Method - Collaboration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factory-method-consequences">Factory Method - Consequences</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parallel-class-hierarchies">Parallel Class Hierarchies</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#factory-method-implementation">Factory Method - Implementation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameterized-factories">Parameterized Factories</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#factory-method-related-patterns">Factory Method - Related Patterns</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Krystian Piękoś - Infotraining
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>